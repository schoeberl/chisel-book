\input{../slides/common/slides_common}

\newif\ifbook
\input{../shared/chisel}

% TikZ for diagrams
\usepackage{tikz}
\usetikzlibrary{positioning, arrows.meta}

% Optional visual tweaks
\tikzset{
    >=Stealth,
    every node/.style={rounded corners=2pt}
}

\title{Co-Simulation and Scrum}
\author{Martin Schoeberl}
\date{\today}
\institute{Technical University of Denmark\\
Embedded Systems Engineering}

\begin{document}

\begin{frame}
\titlepage
\end{frame}




\begin{frame}[fragile]{Outline}
\begin{itemize}
\item Agile is about test-driven development
\item Co-Simulation
\item More on Scrum
\item Your project status
\item Shorter lecture today (need to catch a flight)
\item Nice lab exercise on co-simulation
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Co-Simulation}
\begin{itemize}
\item Write a \emph{golden} model for your hardware
\item Run the hardware and the model in parallel
\item Compare the output
\item Input is sometimes random, or constraint random
\item Who is writing the reference model?
\item Same error in model and implementation?
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Reference Model}
\begin{itemize}
\item A Java or Scala program (for Chisel)
\item A C/C++ model
\item Matlab/Simulink
\item Is it cycle accurate?
\item How to compare when not cycle accurate
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Game of Live Example}
\begin{itemize}
\item \href{https://en.wikipedia.org/wiki/Conway\%27s_Game_of_Life}{Conway's Game of Life}
\item Any live cell with two or three live neighbors survives.
\item Any dead cell with three live neighbors becomes a live cell.
\item All other live cells die in the next generation. Similarly, all other dead cells stay dead.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Game of Live Co-Simulation}
\begin{itemize}
\item An exercise in the Java Introduction to programming
\item The problem is highly parallel
\item I will show you a Chisel (and Java) implementation
\item FPGA version is extremely fast compared to the Java implementation
\item It contains co-simulation
\item \url{https://github.com/schoeberl/game-of-live}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Example: Processor Design}
\begin{itemize}
\item Write an ISA simulation
\item Who did Computer Architecture?
\item You wrote a RISC-V ISA simulation
\item You might do a RISC-V in January
\item There, you should do the co-simulation
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Cycle Accurate Example}
\begin{itemize}
\item \href{https://github.com/schoeberl/lipsi}{Lipsi} processor
\item Tiny processor core
\item Showing it as Chisel motivation
\item Has a cycle-accurate SW model in Scala
\item Let us explore it now
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Non-Cycle Accurate Example}
\begin{itemize}
\item RISC-V core \href{https://github.com/schoeberl/wildcat}{Wildcat}
\item Shall be a teaching reference
\item Several implementations
\begin{itemize}
\item ISA simulation (in Scala)
\item Pipelines: 3, 4, and 5 stages
\item Single cycle (= ISA simulation in Chisel)
\item Multi-cycle planned
\end{itemize}
\item What to compare?
\item How/when to compare?
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Non-Cycle Accurate Example}
\begin{itemize}
\item What to compare:
\begin{itemize}
\item All data goes at some point through the register file
\item Just compare register file content
\item Not so much state (compared to memory content)
\end{itemize}
\item When to compare:
\begin{itemize}
\item One could track updates each clock cycle and advance only on a change
\item When to stop? Timeout if one of the two \emph{hangs}
\item Compare register file content at the end
\item We had this in the Computer Architecture lab
\end{itemize}
\item Explore it now
\end{itemize}
\end{frame}

\begin{frame}[fragile]{When is it Enough?}
\begin{itemize}
\item How much do you need to test?
\item How confident are you?
\item We cannot cover all input possibilities
\item Except in trivial cases
\begin{itemize}
\item Parameters might help
\item Cover all cases for a 4-bit ALU
\item Assume the design also works for 32 bits 
\end{itemize}
\item Any other option?
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Assertions in Chisel}
\begin{itemize}
\item An Assertion statement states assumptions about a program
\item You have seen \code{assert} in Scala in the first lab
\item Can also be used in Chisel
\item Assertion is checked during simulation time
\item Syntax:
\begin{chisel}
  io.sum := io.a + io.b
  assert(io.sum === io.a + io.b, "error message")
\end{chisel}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{\code{require} vs \code{assert}}
\begin{itemize}
\item Chisel \code{assert} checks value in simulation
\begin{itemize}
\item Emits non-synthesizable Verilog
\item Using a Chisel expression that results in a \code{Bool}
\item Can also have a failure message
\end{itemize}
\item Scala \code{assert} checks value at circuit construction
\item Using a Scala expression that results in a \code{Boolean}
\item Better use Scala's \code{require}
\item \code{require} is used for input sanity checking
\shortlist{../code/fifo_abstract.txt}
\end{itemize}
\end{frame}


\begin{frame}[fragile]{Formal Verification}
\begin{itemize}
\item Simulation explores (only) some test cases
\item Formal verification explores \emph{all} possible behaviors
\item Sounds a bit too good to be true, right?
\item We will look into this next week
\end{itemize}
\end{frame}


\begin{frame}[fragile]{More on Agile Development}
\begin{itemize}
\item Scrum is the base methodology for agile development
\item Intended for small groups of developers
\item Provides tools (lists)
\item Defines roles
\item Set of meetings
\item Can also be adapted for single-person teams
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Lists I}
\begin{itemize}
\item Product backlog
\begin{itemize}
\item Work to be done as a priority ordered list
\item Defines your product
\item Start with enough items to get the first and maybe the second sprint started
\item Will change as you develop (the agile part)
\item Priorities will change
\item Source for sprint
\end{itemize}
\item TODO or Sprint backlog
\begin{itemize}
\item Created at the start of the sprint from the Backlog
\item The work  items to be done during the sprint
\item Team self-organized by pulling work from the list
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Lists II}
\begin{itemize}
\item In progress
\begin{itemize}
\item Items moved from TODO into this list
\item Includes who is working on it
\end{itemize}
\item Review
\begin{itemize}
\item Optional, if needed
\end{itemize}
\item Done
\begin{itemize}
\item All work done moves there
\item The work done during a sprint, not the entire project
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Scrum Board}
\begin{itemize}
\item Visualize the Lists
\item Fill at the sprint start
\item Can have user stories in the Y axis
\item Can be physical with Postits
\item Or simple a Google doc
\item Online tool, e.g., \href{https://miro.com/agile/scrum-board/}{miro}
\item Reviewed at the sprint end
\item Provides transparancy
\begin{itemize}
\item Everyone sees what is going on
\item No hidden agenda
\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}[fragile]{Scrum Roles}
\begin{itemize}
\item Product Owner
\begin{itemize}
\item Knows the domain
\item Makes decisions (e.g., product vision)
\item Accountable for value
\item Not a boss
\end{itemize}
\item Scrum Master
\begin{itemize}
\item Not a manager, a servant leader
\item Guide the team, the meetings
\item Asks questions
\begin{itemize}
\item What can we change in our work?
\item What are our b igest obstacles?
\end{itemize}
\end{itemize}
\item Developers
\begin{itemize}
\item Do the work self organized
\item Move topics from TODO to In Progress
\item And then to Done
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Daily Scrum Meeting}
\begin{itemize}
\item Heartbeat of Scrum
\item Each day, at the same time
\item Maximum 15'
\item Standup meeting
\item Team and Scrum master meet
\item Ask the following questions:\footnote{Sutherland, Jeff; Sutherland, J.J.. Scrum: The Art of Doing Twice the Work in Half the Time (p. 237). (Function). Kindle Edition.}
\begin{itemize}
\item What did you do yesterday to help the team finish the Sprint?
\item What will you do today to help the team finish the Sprint?
\item Is there any obstacle blocking you or the team from achieving the Sprint Goal?
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Other Scrum Meetings}
\begin{itemize}
\item Sprint planning
\begin{itemize}
\item Decide on the goal of the sprint
\item Move tasks from backlog to TODO
\end{itemize}
\item Sprint review
\begin{itemize}
\item Demo what has been done---something that can be used
\item Feedback at the end of the sprint
\item Ideal with your customer
\end{itemize}
\item Sprint retrospective
\begin{itemize}
\item Reflect on the review
\item Find ways to improve the process
\end{itemize}
\item Backlog refinement
\begin{itemize}
\item Change the project/priorities
\item Can happen as you feel the need
\item Cleanup backlog
\item Shift priorities
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{What Do you Do?}
\begin{itemize}
\item Having meetings?
\item Using Scrum?
\item Using a Scrum board?
\item Or a TODO list?
\item Tell me
\end{itemize}
\end{frame}


\begin{frame}[fragile]{Summary}
\begin{itemize}
\item Co-simulation as an advanced version of testing
\item Some more talking about Scrum
\item Today's lab brought to you by Javad
\item Now it is your turn to present
\end{itemize}
\end{frame}


\end{document}

\begin{frame}[fragile]{XXX}
\begin{itemize}
\item xxx
\item xxx
\item xxx
\begin{itemize}
\item xxx
\end{itemize}
\item xxx
\item xxx
\end{itemize}
\end{frame}
